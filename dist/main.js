!function(t){var e={};function i(s){if(e[s])return e[s].exports;var a=e[s]={i:s,l:!1,exports:{}};return t[s].call(a.exports,a,a.exports,i),a.l=!0,a.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var a in t)i.d(s,a,function(e){return t[e]}.bind(null,a));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,i){"use strict";i.r(e);const s={CAPY_WIDTH:45,CAPY_HEIGHT:33,GRAVITY:.4,FLAP_SPEED:7.5,TERMINAL_VEL:12,ANIMATED_FLAP_SPEED:5};class a{constructor(t){this.dimensions=t,this.x=t.width/3,this.y=t.height/2,this.vel=0,this.capyCounter=0,this.capySprite1=new Image,this.capySprite2=new Image,this.capySprite3=new Image,this.capySprite1.src="assets/images/capy-wings1.png",this.capySprite2.src="assets/images/capy-wings2.png",this.capySprite3.src="assets/images/capy-wings3.png"}animate(t){this.moveCapy(),this.drawCapy(t)}drawCapy(t){let e;this.capyCounter++,this.capyCounter<=1*s.ANIMATED_FLAP_SPEED?e=this.capySprite1:this.capyCounter<=2*s.ANIMATED_FLAP_SPEED?e=this.capySprite2:this.capyCounter<=3*s.ANIMATED_FLAP_SPEED?e=this.capySprite3:this.capyCounter<=4*s.ANIMATED_FLAP_SPEED&&(this.capyCounter=0,e=this.capySprite2),t.drawImage(e,this.x,this.y)}moveCapy(){if(this.y+=this.vel,this.vel+=s.GRAVITY,Math.abs(this.vel)>s.TERMINAL_VEL)switch(this.vel>0){case!0:this.vel=s.TERMINAL_VEL;break;case!1:this.vel=-1*s.TERMINAL_VEL}}flap(){this.vel=-1*s.FLAP_SPEED}bounds(){return{left:this.x,right:this.x+s.CAPY_WIDTH,top:this.y,bottom:this.y+s.CAPY_HEIGHT}}outOfBounds(){const t=this.y<0,e=this.y+s.CAPY_HEIGHT>this.dimensions.height;return t||e}}const n={HORIZONTAL_PIPE_SPACING:220,PIPE_GAP:150,WARMUP_SECONDS:1,EDGE_BUFFER:50,PIPE_WIDTH:50,PIPE_SPEED:2,PIPE_IMAGE_HEIGHT:640,BACKGROUND_SPEED:1};class o{constructor(t){this.dimensions=t;const e=this.dimensions.width+60*n.WARMUP_SECONDS*n.PIPE_SPEED;this.pipes=[this.randomPipe(e),this.randomPipe(e+n.HORIZONTAL_PIPE_SPACING),this.randomPipe(e+2*n.HORIZONTAL_PIPE_SPACING)];let i=this.makeBackground();this.backgroundQueue=[i],this.appendBackground=!0}makeBackground(){const t={image:new Image,pos:-1440};return this.appendBackground&&(t.pos=480,this.appendBackground=!1),t.image.src="assets/images/background-sky-and-grass.png",t}animate(t){this.movePipes(),this.drawPipes(t)}animateBackground(t){this.moveAnimatedBackground(),this.drawAnimatedBackground(t)}drawPipes(t){this.eachPipe(function(e){let i=e.topPipe.bottom-e.topPipe.top,s=e.bottomPipe.bottom-e.bottomPipe.top,a=new Image;a.src="assets/images/top-pipe.png",t.drawImage(a,e.topPipe.left,i-n.PIPE_IMAGE_HEIGHT);let o=new Image;o.src="assets/images/bottom-pipe.png",t.drawImage(o,e.bottomPipe.left,n.PIPE_IMAGE_HEIGHT-s)})}movePipes(){if(this.eachPipe(function(t){t.topPipe.left-=n.PIPE_SPEED,t.topPipe.right-=n.PIPE_SPEED,t.bottomPipe.left-=n.PIPE_SPEED,t.bottomPipe.right-=n.PIPE_SPEED}),this.pipes[0].topPipe.right<=0){this.pipes.shift();const t=this.pipes[1].topPipe.left+n.HORIZONTAL_PIPE_SPACING;this.pipes.push(this.randomPipe(t))}}moveAnimatedBackground(){switch(this.backgroundQueue[0].pos){case-1440:this.backgroundQueue.push(this.makeBackground()),this.appendBackground=!0;break;case-1920:this.backgroundQueue.shift()}this.backgroundQueue.forEach(t=>{t.pos-=n.BACKGROUND_SPEED})}drawBackground(t){t.fillStyle="skyblue",t.fillRect(0,0,this.dimensions.width,this.dimensions.height)}drawAnimatedBackground(t){this.backgroundQueue.forEach(e=>{t.drawImage(e.image,e.pos,0)})}eachPipe(t){this.pipes.forEach(t.bind(this))}collidesWith(t){const e=(t,e)=>!(t.left>e.right||t.right<e.left)&&!(t.top>e.bottom||t.bottom<e.top);let i=!1;return this.eachPipe(s=>{(e(s.topPipe,t)||e(s.bottomPipe,t))&&(i=!0)}),i}passedPipe(t,e){this.eachPipe(i=>{i.topPipe.right<t.left&&(i.passed||(i.passed=!0,e()))})}randomPipe(t){const e=this.dimensions.height-2*n.EDGE_BUFFER-n.PIPE_GAP,i=Math.random()*e+n.EDGE_BUFFER;return{topPipe:{left:t,right:n.PIPE_WIDTH+t,top:0,bottom:i},bottomPipe:{left:t,right:n.PIPE_WIDTH+t,top:i+n.PIPE_GAP,bottom:this.dimensions.height},passed:!1}}}class r{constructor(t,e){this.ctx=t.getContext("2d"),this.dimensions={width:t.width,height:t.height},this.audioObj=e,this.registerEvents(),this.restart()}animate(){this.level.animate(this.ctx),this.gameOver()&&(alert(`What a scrub, you only got ${this.score} points`),this.restart()),this.level.passedPipe(this.capy.bounds(),()=>{this.score++}),this.drawScore(),this.running&&(this.audioObj.start.pause(),this.audioObj.gameplay.play(),requestAnimationFrame(this.animate.bind(this)))}animateLevelBackground(){this.level.drawBackground(this.ctx),this.level.animateBackground(this.ctx),this.running&&this.capy.moveCapy(),this.capy.drawCapy(this.ctx),requestAnimationFrame(this.animateLevelBackground.bind(this))}drawScore(){const t=10,e=60;this.ctx.font="bold 50pt serif",this.ctx.fillStyle="white",this.ctx.fillText(`Score: ${this.score}`,t,e),this.ctx.strokeStyle="black",this.ctx.lineWidth=2,this.ctx.strokeText(`Score: ${this.score}`,t,e)}play(){this.running=!0,this.animate()}restart(){this.audioObj.gameplay.currentTime=0,this.audioObj.gameplay.pause(),this.audioObj.start.currentTime=0,this.audioObj.start.play(),this.running=!1,this.level=new o(this.dimensions),this.capy=new a(this.dimensions),this.backgroundRunning||(this.animateLevelBackground(),this.backgroundRunning=!0),this.score=0,this.animate()}registerEvents(){this.ctx.canvas.addEventListener("mousedown",()=>{this.running||this.play(),this.capy.flap()}),this.backgroundRunning=!1}gameOver(){return this.level.collidesWith(this.capy.bounds())||this.capy.outOfBounds()}}const h=document.getElementById("capy-game"),p={start:document.getElementById("start-audio"),gameplay:document.getElementById("gameplay-music"),dead:document.getElementById("dead")};window.onload=function(){setTimeout(()=>{new r(h,p)},50)}}]);